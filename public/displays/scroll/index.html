<!DOCTYPE html>
<!--
	Scroll Display for the HCII Bulletin Board
	Licensed under the MIT License (http://www.opensource.org/licenses/mit-license.php).
-->
<html>
<head>
	<title>Scroll - HCII Bulletin Board</title>
	
	<style type="text/css">
	html,body {
		margin:0;
		padding:0;
		background-color:#999;
	}
	#display {
		color:#000;
	}
		#display>.cell {
			float:left;
			margin:3px;
			padding:5px;
			background-color:#fff;
			text-align:center;
			-webkit-box-shadow:0 3px 5px rgba(0,0,0,0.5);
			-moz-box-shadow:0 3px 5px rgba(0,0,0,0.5);
			box-shadow:0 3px 5px rgba(0,0,0,0.5);
			z-index:0;
		}
		#display>.cell>.img-box {
			margin-bottom:3px;
			width:120px;
			height:120px;
			overflow:hidden;
		}
		#display>.cell>.img-box>img {
			width:120px;
		}
		#display>.cell>.name {
			font-family:Helvetica,Arial,sans-serif;
			font-size:11px;
		}

	.row { width: 800px; height: 130px; overflow-x: hidden; overflow-y: hidden; display: inline-block; }
	.row-items { width: 10000px; height: 130px; }
	.profile { display: inline; }
	.infobox { position: fixed; width: 130px; height: 180px; z-index: 99; background: #ccc;  }
	#faculty-info { top: 9px; left: 200px; }
	#staff-info { top: 146px; left: 550px; }
	#phd-info { top: 279px; left: 150px; }
	#masters-info { top: 416px; left: 400px; }
	.info-pic { width: 130px; height: 130px; }
	</style>
</head>
<body>
	
<div id="display"></div>

<!-- Javascripts -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="http://cdn.ianli.com/javascripts/underscore/1.1.6/underscore.min.js"></script>
<script type="text/javascript" src="jquery.scrollTo.js"></script>
<script type="text/javascript">

picWidth = 130;
faculty = [];
staff = [];
masters = [];
phd = [];
whichFac = 0;
whichStaff = 0;
whichPhd = 0;
whichMasters = 0;
intervalLen = 1200;
count = 0;

// The template for the cells that appear in the display.
var template = _.template(
	'<div class="cell">' +
		'<div class="img-box">' +
			'<img src="<%= image %>" />' +
		'</div>' +
		'<div class="name"><%= first_name %> <%= last_name %></div>' +
	'</div>'
);

// Fetch the JSON file of people.
$.getJSON('/people.json', function (data, textStatus, jqXHR) {
	_.each(data, function (value, i) {
		if (!value.person.image) {
			// Set image to a default blank image.
			value.person.image = 'blank.png';
		} 

		if (!value.person.room) { 
			value.person.room = "";
		}
	});

	_.each(data, function (value, i) {
		appendProfile(value.person, value.person.level);
		
		if (value.person.level == 'faculty') {
			faculty.push(value.person);
		} else if (value.person.level == 'staff') {
			staff.push(value.person);
		} else if (value.person.level == 'phd') {
			phd.push(value.person);
		} else if (value.person.level == 'masters') {
			masters.push(value.person);
		}
	});

	numFac = faculty.length;
	numStaff = staff.length;
	numPhd = phd.length;
	numMasters = masters.length;

	setInterval(imageScroll, intervalLen);

});

var appendProfile = function(person, level) {
	//$("#" + level + "-row").css('width', $("#" + level + "-row").css('width')+picWidth);
	var profile_tag = $("<li>").addClass("profile")
	var profile_img_tag = $("<img>").attr("src", person.image)
	profile_img_tag.attr("height", 130)
		       .attr("width", 130)
		       .appendTo(profile_tag);
	$("#" + level + "-row").append(profile_tag);
};

var showInfo = function() {
	var person = faculty[whichFac];
	var featured_img_tag = $("<img>").addClass("info-pic").attr("src", person.image);
	$("#faculty-info").html(person.first_name + " " + person.last_name + "<br />" + person.room)
			  .prepend(featured_img_tag);

	person = staff[whichStaff];
	featured_img_tag = $("<img>").addClass("info-pic").attr("src", person.image);
	$("#staff-info").html(person.first_name + " " + person.last_name + "<br />" + person.room)
		        .prepend(featured_img_tag);

	person = phd[whichPhd];
	featured_img_tag = $("<img>").addClass("info-pic").attr("src", person.image);
	$("#phd-info").html(person.first_name + " " + person.last_name + "<br />" + person.room)
		        .prepend(featured_img_tag);

	person = masters[whichMasters];
	featured_img_tag = $("<img>").addClass("info-pic").attr("src", person.image);
	$("#master-info").html(person.first_name + " " + person.last_name + "<br />" + person.room)
		       	.prepend(featured_img_tag);



}

var imageScroll = function() { 
	count = count + 1;
	whichFac = (whichFac + 1) % numFac;
	$("#faculty-box").scrollTo($("#faculty-row li:nth-child(" + whichFac + ")"), intervalLen, { axis : "x", onAfter: showInfo, easing : "linear" });

	whichStaff = (whichStaff + 1) % numStaff;
	$("#staff-box").scrollTo($("#staff-row li:nth-child(" + whichStaff + ")"), intervalLen, { axis : "x", onAfter: showInfo, easing : "linear" });

	whichPhd = (whichPhd + 1) % numPhd;
	$("#phd-box").scrollTo($("#phd-row li:nth-child(" + whichPhd + ")"), intervalLen, { axis : "x", onAfter: showInfo, easing : "linear" });

	whichMasters = (whichMasters + 1) % numMasters;
	$("#masters-box").scrollTo($("#masters-row li:nth-child(" + whichMasters + ")"), intervalLen, { axis : "x", onAfter: showInfo, easing : "linear" });


};



</script>

<div id="faculty-info" class="infobox"></div>
<div id="faculty-box" class="row"><ul id="faculty-row" class="row-items"></ul></div>

<div id="staff-info" class="infobox"></div>
<div id="staff-box" class="row"><ul id="staff-row" class="row-items"></ul></div>

<div id="phd-info" class="infobox"></div>
<div id="phd-box" class="row"><ul id="phd-row" class="row-items"></ul></div>

<div id="masters-info" class="infobox"></div>
<div id="masters-box" class="row"><ul id="masters-row" class="row-items"></ul></div>

</body>
</html>
